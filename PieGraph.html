<html>
	<head>
		<title>Pie Graph HTML</title>
		<style>
			* {
				margin: 10px;
				padding: 0;
			}
			#container {
				width: 900px;
				margin: auto;
			}
			svg {
				float: left;
			}
			#article {
				padding: 2px;
			}
			#pieDatas {
				width: 150px;
			}
			.clear {
				clear: both;
				float: none;
			}
		</style>
	</head>
	
	<body>
		<div id="container">
			<svg width="500" height="410">
			   <circle cx="250" cy="206" r="200" stroke="black" stroke-width="4" fill="white"/>
			   <line />
			   <line />
			   <line />
			   <line />
			</svg>
			<div id="article">
				<h2>PIE GRAPH</h2>
				<hr />
				Faddi Susanto&copy; 2020
				<br /><br />
				<span>[]</span> = Data Pie 1
				<br />
				<span>[]</span> = Data pie 2
				<br />
				<span>[]</span> = Data pie 3
				<br />
				<span>[]</span> = Data pie 4
				<br /><br />
				<div id="overallData"></div>
			</div>
			<div class="clear"></div>
			Data Pie 1 : <input type="text" class="dataPie" size="3" maxlength="5"/> <br />
			Data Pie 2 : <input type="text" class="dataPie" size="3" maxlength="5" /> <br />
			Data Pie 3 : <input type="text" class="dataPie" size="3" maxlength="5" /> <br />
			Data Pie 4 : <input type="text" class="dataPie" size="3" maxlength="5" /> <br />
			<button class="dataPie" onclick="loadPieData();">OK!</button>
		</div>
		
		<script type="text/javascript">
			function loadPieData() {
				initAttribute();
				var i=0, data=[], className=document.getElementsByClassName("dataPie");
				while(i<className.length-1) {
					if(className[i].value !== "") {
						data.push(className[i].value);
					}
					i++;
				}
				var endPoint = initialMathData(data);
				callLineEndPoint(endPoint);
			}
			
			function initAttribute() {
				var i=0;
				while(i<document.getElementsByTagName("line").length) {
					document.getElementsByTagName("line")[i].removeAttribute("x1");
					document.getElementsByTagName("line")[i].removeAttribute("y1");
					document.getElementsByTagName("line")[i].removeAttribute("x2");
					document.getElementsByTagName("line")[i].removeAttribute("y2");
					document.getElementsByTagName("line")[i].removeAttribute("style");
					i++;
				}
			}
			
			function initialMathData(data) {
				var i=data.length, ret=[], defaultPI = (2*Math.PI) * 1;
				var biggestData = calculateBiggestData(data);
				var smallestData = calculateSmallestData(data);
				var dataPercent = calculateDataPercent(data);
				if(i==2) {
					var pi2 = (2*Math.PI) * ((biggestData/dataPercent)/100);
					ret.push(calculateEndPoint(defaultPI));
					ret.push(calculateEndPoint(pi2));
					callOverallData(data,dataPercent);
					return ret;
				} else if(i==3) {
					var pi2 = (2*Math.PI) * ((biggestData/dataPercent)/100);
					var pi3 = (2*Math.PI) * (((biggestData/dataPercent)+(smallestData/dataPercent))/100);
					ret.push(calculateEndPoint(defaultPI));
					ret.push(calculateEndPoint(pi2));
					ret.push(calculateEndPoint(pi3));
					callOverallData(data,dataPercent);
					return ret;
				} else if(i==4){
					var secondBiggestData = calculateSecondBiggestData(data, biggestData, smallestData);
					var pi2 = (2*Math.PI) * ((biggestData/dataPercent)/100);
					var pi3 = (2*Math.PI) * (((biggestData/dataPercent)+(secondBiggestData/dataPercent))/100);
					var pi4 = (2*Math.PI) * (((biggestData/dataPercent)+(secondBiggestData/dataPercent)+(smallestData/dataPercent))/100);
					ret.push(calculateEndPoint(defaultPI));
					ret.push(calculateEndPoint(pi2));
					ret.push(calculateEndPoint(pi3));
					ret.push(calculateEndPoint(pi4));
					callOverallData(data,dataPercent);
					return ret;
				} else {
					alert("Data Pie Yang Dimasukkan Harus Lebih Dari 1");
					return;
				}
			}
			
			function calculateDataPercent(data) {
				var i=0, ret=0;
				while(i<data.length) {
					ret+=parseInt(data[i]);
					i++;
				}
				return ret/100;
			}
			
			function calculateBiggestData(data) {
				var i=0, ret=parseInt(data[0]);
				while(i<data.length) {
					if(parseInt(data[i])>ret) ret=parseInt(data[i]);
					i++;
				}
				return ret;
			}
			
			function calculateSecondBiggestData(data, biggestData, smallestData) {
				var i=0, ret = smallestData;
				while(i<data.length) {
					if(parseInt(data[i])>ret && parseInt(data[i])<biggestData) ret = parseInt(data[i]);
					i++;
				}
				return ret;
			}
			
			function calculateSmallestData(data) {
				var i=0, ret=parseInt(data[0]);
				while(i<data.length) {
					if(parseInt(data[i])<ret) ret=parseInt(data[i]);
					i++;
				}
				return ret;
			}
			
			function calculateEndPoint(PI) {
				var ret=[];
				ret.push(250 - 200 * Math.cos(PI));
				ret.push(205 - 200 * Math.sin(PI));
				return ret;
			}
			
			function callOverallData(data,dataPercent) {
				var i=0, overall = "";
				while(i<data.length) {
					var j=i+1;
					overall += "<b>Data Pie " + j + "</b> sejumlah <font color='red'>" + 
							data[i] + "</font> Berada pada <font color='blue'>" + 
							(100/(100*dataPercent))*parseInt(data[i]) + "%</font><br />";
					i++;
				}
				document.getElementById("overallData").innerHTML = overall;
			}
			
			function callLineEndPoint(endPoint) {
				var i=0;
				while(i<endPoint.length) {
					document.getElementsByTagName("line")[i].setAttribute("x1", "250");
					document.getElementsByTagName("line")[i].setAttribute("y1", "205");
					document.getElementsByTagName("line")[i].setAttribute("x2", endPoint[i][0]);
					document.getElementsByTagName("line")[i].setAttribute("y2", endPoint[i][1]);
					document.getElementsByTagName("line")[i].setAttribute("style", "stroke:rgb(0,0,0);stroke-width:4");
					i++;
				}
			}			
		</script>
		
	</body>

</html>